# ============================================================================
# DEV.com Orchestrator - Cloudflare Workers Configuration
# ============================================================================

name = "dev-com-orchestrator"
main = "src/index.ts"
compatibility_date = "2024-12-01"
compatibility_flags = ["nodejs_compat"]

# ============================================================================
# Workers AI
# ============================================================================
[ai]
binding = "AI"

# ============================================================================
# D1 Database
# ============================================================================
[[d1_databases]]
binding = "DB"
database_name = "dev-com-db"
database_id = "placeholder-update-after-creation"

# ============================================================================
# R2 Storage
# ============================================================================
[[r2_buckets]]
binding = "STORAGE"
bucket_name = "dev-com-storage"

# ============================================================================
# KV Namespace
# ============================================================================
[[kv_namespaces]]
binding = "CACHE"
id = "placeholder-update-after-creation"

# ============================================================================
# Durable Objects
# ============================================================================
[durable_objects]
bindings = [
  { name = "ORCHESTRATOR_DO", class_name = "OrchestratorDO" },
  { name = "AGENT_DO", class_name = "AgentDO" }
]

[[migrations]]
tag = "v1"
new_sqlite_classes = ["OrchestratorDO", "AgentDO"]

# ============================================================================
# Environment Variables
# ============================================================================
[vars]
ENVIRONMENT = "development"

# ============================================================================
# Secrets (configure via wrangler secret put)
# ============================================================================
# GITHUB_TOKEN = "..."

# ============================================================================
# Development
# ============================================================================
[dev]
port = 8787
local_protocol = "http"
